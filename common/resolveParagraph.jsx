/*【概要】複数行のテキストレイヤーを1行ずつに分解する。【備考】・自動カーニングがうまくコピーできない・一文字ずつサイズやカーニングを調整した時のデータが取れない2014.12.26 IKOYAMA*///Main --------------------------------------------------var doc = activeDocument;var layers = doc.layers;var line_space ;//行間var layer ;//新規レイヤーを入れるコンテナvar paragraph ;//textItemvar line ;//1行分のstringの配列var original_layer = doc.activeLayer ;if(original_layer.kind == LayerKind.TEXT){//テキストレイヤーを選択しているかどうか    paragraph = original_layer.textItem;    line = paragraph.contents.split(/\r\n|\r|\n/);//改行でストリングを分割        if(line <= 1){        alert("複数行のテキストレイヤーを選択してください");    }else{        main();    }}else{    alert("テキストレイヤーを選択してください");}//functions --------------------------------------------------function main(){    try{        if(paragraph.useAutoLeading){// 行間が自動の場合  TODO:たまにuseAutoLeadingがないことがある。原因不明。            line_space = paragraph.size*paragraph.autoLeadingAmount/100;        }else{            line_space = paragraph.leading;        }    }catch(e){        alert("error:" + e);        line_space = paragraph.size*1.5;            }        original_layer.visible  = true;    for(var i = 0 ; i < line.length ; i++){            doc.activeLayer = original_layer;        original_layer.duplicate();//元レイヤーをコピー        selectPrevLayer();//新規に追加したレイヤーを選択        layer = doc.activeLayer;         layer.textItem.contents = line[i];        layer.name = line[i];        layer.translate(0,line_space*i)    }    original_layer.visible  = false;//元レイヤーを非表示}//ひとつ上のレイヤーを選択function selectPrevLayer(){    var idslct = charIDToTypeID( "slct" );    var desc11562 = new ActionDescriptor();    var idnull = charIDToTypeID( "null" );    var ref4594 = new ActionReference();    var idLyr = charIDToTypeID( "Lyr " );    var idOrdn = charIDToTypeID( "Ordn" );    var idFrwr = charIDToTypeID( "Frwr" );    ref4594.putEnumerated( idLyr, idOrdn, idFrwr );    desc11562.putReference( idnull, ref4594 );    var idMkVs = charIDToTypeID( "MkVs" );    desc11562.putBoolean( idMkVs, false );    executeAction( idslct, desc11562, DialogModes.NO );}