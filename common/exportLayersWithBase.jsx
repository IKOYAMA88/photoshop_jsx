/************************************************************【概要】    ・レイヤー毎にpng24で書き出します【細かい条件など】・例外で、"base"という名前のレイヤーおよびレイヤーグループは、常に表示した状態で書き出します・選択したディレクトリ直下の全てのpsdデータに対し、処理を行います。・書き出されたpngファイルは元ファイルと同じディレクトリに入れられます。***********************************************************/var pngOpt = new PNGSaveOptions();pngOpt.interlaced = false; var doc;var layers;var baseLayers = [];    //無視したいレイヤーvar visibleLayers = []; //もともと表示してたレイヤーvar saveLayers = [];    //保存したいレイヤーvar folderPath;var fileName;var folderObj;/***********************************************************///メインの処理if(activeDocument){    init();    showAllLayers(baseLayers);  //baseレイヤーを全て表示    hideAllLayers(saveLayers);  //baseレイヤー以外を全て非表示    for (i=0; i<saveLayers.length; i++){            　　　exportLayer(saveLayers[i]);    }    hideAllLayers(baseLayers);  //baseレイヤーを全て非表示        showAllLayers(visibleLayers); //最初に表示されていたレイヤーを全て表示    alert("処理が完了しました");}/******************************************************///変数の準備function init(){    doc = activeDocument;    layers = doc.layers;     devideLayers(layers);        folderPath = String(doc.path);    fileName = String(doc.name).split(".")[0];    folderObj = new Folder (folderPath + "/" + fileName);    folderObj.create();    }//保存するfunction exportLayer (_layer){    _layer.visible = true;    var savename = createSaveName(_layer);    doc.saveAs(savename, pngOpt, true, Extension.LOWERCASE);    _layer.visible = false;}//保存名を作るfunction createSaveName(_layer){    var layerName = String(_layer.name);    var savename = new File(folderPath + "/" + fileName + "/"+layerName+".png");    return savename;}//レイヤーを全て非表示にするfunction hideAllLayers(_layers){   for(var i=0; i< _layers.length; i++){        _layers[i].visible = false;   }    }//レイヤーを全て表示するfunction showAllLayers(_layers){   for(var i=0; i< _layers.length; i++){        _layers[i].visible = true;   }    }//レイヤーの配列を作るfunction devideLayers(_layers){    for(var i=0; i< _layers.length; i++){        if(_layers[i].visible){            visibleLayers.push(_layers[i]);        }                if(layers[i].name == "base"){            baseLayers.push(_layers[i]);        }else{            saveLayers.push(_layers[i]);                   }    } }