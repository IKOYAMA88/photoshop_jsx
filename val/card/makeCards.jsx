//cardディレクトリのパスを入力して下さいvar source="~/Desktop/card/"/*-----------------------------------------------------------------*/app.displayDialogs = DialogModes.NO; preferences.rulerUnits = Units.PIXELS;var folderList = ["battleL", "battleR", "cut_in", "flash_battle", "full", "icon", "log_middle", "mypage"];var cardList = [    {name:"cut_in", w:720, h:180,x:0,y:0,frame:false},    {name:"full", w:1440, h:1920,x:0,y:0,frame:true},    {name:"icon", w:240, h:320,x:0,y:0,frame:true},    {name:"log_middle", w:480, h:250,x:0,y:0,frame:true},    {name:"mypage", w:640, h:460,x:0,y:0,frame:true}];var doc = activeDocument;var layerList = doc.layers; var sourceW = doc.width;var sourceH = doc.height;var illust = getLayer("illust");/*-----------------------------------------------------------------*/main();function main(){    //説明レイヤーを削除    removeByForce(getLayer("attention"));        //フォルダーを作る。既にある場合は動かないっぽい。    makeFolder();    for (var i=0; i < cardList.length; i++){        if(illust){            showTargetLayer(cardList[i]);            doc.resizeCanvas(cardList[i].w, cardList[i].h, AnchorPosition.TOPLEFT);            illust.translate(cardList[i].x,cardList[i].y);            saveAsPsd(cardList[i].name);                        //元に戻す                        doc.resizeCanvas(sourceW,sourceH,AnchorPosition.TOPLEFT);            illust.translate(-cardList[i].x,-cardList[i].y);            removeByForce(getLayer(cardList[i].name));        }else{            alert("illustが見つかりませんでした。");            break;        }    }    doc.close();    alert("終了");}/*-----------------------------------------------------------------*///フォルダーを作成function makeFolder(){        for(i = 0; i < folderList.length; i++){            var folder = new Folder(source + "/" + folderList[i])            folder.create();    }}//必要なレイヤーだけを表示するfunction showTargetLayer(_cardObj){    hideAllLayer();    if(_cardObj.frame){        var targetLayer = getLayer(_cardObj.name);        if(targetLayer ){            targetLayer .visible = true;        }else{            alert(_cardObj.name + "がありませんでした");        }    }    illust.visible = true;}// 引数と同じ名前ののレイヤーを取得function getLayer(_name){    //var targetLayer;    for(i = 0; i < layerList.length; i++){        if(layerList[i].name == _name){                return layerList[i];                break;        }            }    }//全部非表示時にするfunction hideAllLayer(){    for(i = 0; i < layerList.length; i++){        layerList[i].visible = false;    }}//保存function saveAsPsd(_folder){    var fileName = (source + "/" +_folder +"/"+ doc.name.toString());    var savename = new File(fileName);          var psd_Opt = new PhotoshopSaveOptions();    psd_Opt.layers = true; // Preserve layers.    psd_Opt.embedColorProfile = true; // Preserve color profile.    psd_Opt.annotations = true; // Preserve annonations.    psd_Opt.alphaChannels = true; // Preserve alpha channels.    psd_Opt.spotColors = true; // Preserve spot colors.    activeDocument.saveAs(savename, psd_Opt, true );  }//説明レイヤーの削除、イラストレイヤーの取得function removeByForce(_layer){    if(_layer){        if(_layer.allLocked){           _layer.allLocked = false;        }        _layer.remove();            }}