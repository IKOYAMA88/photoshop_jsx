var doc = activeDocument;var target;var allInfo=doc.name + "¥n" + "Filename,PosX,PosY,scaleX,ScaleY,Rotate,Z-order" + "¥n";var items = doc.layers[0].placedItems;for(var i=0;i<items.length;i++){    target = items[i];    var divisionName = String(target.file).split("/");        var fileName = decodeURI(divisionName[divisionName.length-1]);    var fileNameBool =     (fileName =="forearm_l.png")||(fileName == "upperarm_l.png")||    (fileName == "hand_r.png")||(fileName == "forearm_r.png")||(fileName == "hand_l.png")||    (fileName == "body.png")||(fileName == "leg_l.png")||(fileName == "foot_l.png")||    (fileName == "thigh_l.png")||(fileName == "leg_r.png")||(fileName == "foot_r.png")||    (fileName == "thigh_r.png")||(fileName == "upperarm_r.png")||(fileName == "tail.png");    if(fileNameBool){        fileName = "avatar/protector/{0}_[M or F]/" + fileName;    }else if(fileName == "hair.png"){        fileName = "avatar/hair/{0}.png";    }else if(fileName == "face.png"){        fileName = "avatar/face_normal/{0}.png";            }else if(fileName == "head.png"){        fileName = "avatar/head/{0}.png";    }else{        fileName = "avatar/" + fileName.split(".")[0] + "/{0}.png";    }    var x = Math.round(target.position[0]);    var y = Math.round(-target.position[1]);    var centerX = x + Math.round(target.width/2);    var centerY = y + Math.round(target.height/2);        var z = items.length-(target.zOrderPosition);        var scaleX = Math.round(getVerticalScaleReal(target)*100)/100;    var scaleY = Math.round(getHorizontalScaleReal(target)*100)/100;        var tempRotate = getRotationX(target);    var rotate = cleanRotate(tempRotate);        //反転してるかどうか見る式。自分で書いたけど意味はわからない。    //-0~-45、135〜180の間がバグッてるくさい    var  CD = Boolean(target.matrix.mValueD>target.matrix.mValueC);    var rX = Boolean(getRotationX(target)*(-1)>0);    var bool45 = (rotate<0&&rotate>-45)||(rotate<180&&rotate>135);    var mirror = (CD!=rX);    if(bool45){        mirror = !(CD!=rX);    }    if(mirror){        if(rotate==0){            scaleX *= -1;                     }else{            scaleY *= -1;        }       var temp =rotate+180;        rotate = temp;    }    rotate = cleanRotate(rotate);    //var itemInfo="{name_parts:'"+fileName+"',x:"+centerX+",y:"+centerY+",scaleX:"+scaleX+",scaleY:"+scaleY+",rotate:"+rotate+",z-index:"+z+"¥n";    var itemInfo=fileName+","+centerX+","+centerY+","+scaleX+","+scaleY+","+rotate+","+z+"¥n";    allInfo += itemInfo;}function cleanRotate(rote){    if(rote>180){        return (rote-360);    }else if(rote<-180){        return (rote+360);            }else{        return rote;    }}alert(allInfo);/************************************************///rotateXを使って角度出した方が良さそうfunction getRotationX(obj){    if(!obj){return false};    return Math.round(Math.atan2(obj.matrix.mValueB, obj.matrix.mValueA)*180/Math.PI);}function getRotationY(obj){    if(!obj){return false};    return Math.round(Math.atan2(obj.matrix.mValueC, obj.matrix.mValueD)*180/Math.PI);}//拡大縮小率。反転しても負の値にならないっぽい。function getVerticalScaleReal(obj){    if(!obj){return false};    return Math.sqrt(Math.pow(obj.matrix.mValueC,2) + Math.pow(obj.matrix.mValueD,2));}function getHorizontalScaleReal(obj){    if(!obj){return false};    return Math.sqrt(Math.pow(obj.matrix.mValueA,2) + Math.pow(obj.matrix.mValueB,2));}//getMilrrorがX→水平反転、Y→垂直反転、false→反転無しfunction getMirror(obj){    if(!obj){return false};    if(isMirrorX(obj))return 'X';		    if(isMirrorY(obj))return 'Y';    return false;}function isMirrorX(obj){    //$.bp();    if(!obj){return null};    if(obj.matrix.mValueTX*obj.matrix.mValueTY < 0)return false;    return obj.matrix.mValueTX < 0 ? false : true;}function isMirrorY(obj){    if(!obj){return null};    if(obj.matrix.mValueTX*obj.matrix.mValueTY < 0)return false;    return obj.matrix.mValueTY > 0 ? false : true;}